<html lang="ja">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
<link rel="stylesheet" href="style.css">
<title>ファイルの検査と修復</title>
</head>
<body>

<font size=5>ファイルを検査して修復するために</font><br>&nbsp
ファイルを検査して、欠落や破損が見つかれば修復することができます。
修復する前にやっておくことや、修復できなかった時にやることがあります。
<hr>

<h3>検査するファイルを指定して MultiPar を起動する方法</h3>
<p>&nbsp
<a href="option1.htm">「システム関係」のページ</a>で設定しておけば、
リカバリ・ファイルを指定して MultiPar を起動することができます。
MultiPar を起動してから「開く」ボタンで、リカバリ・ファイルを指定するよりも楽です。
同じセットのリカバリ・ファイルが複数ある時でも、どれか一個だけを指定してください。
複数のファイルを指定してしまうと、作成画面が開いたり、検査画面が何個も開かれます。
<dl><dt>
「〜ファイルを関連付ける」にチェックを入れてる場合
</dt><dd>&nbsp
エクスプローラーなどでリカバリ・ファイルを選択してから右クリックすると、
右クリック・メニューが表示されます。
その中の「<b>MultiPar で開く</b>」をクリックします。
あるいは、開きたいリカバリ・ファイルをダブル・クリックします。
</dd></dl>
<dl><dt>
「MultiPar をシェルに統合する」にチェックを入れてる場合
</dt><dd>&nbsp
エクスプローラーなどでリカバリ・ファイルを選択してから右クリックすると、
右クリック・メニューが表示されます。
その中の「<b>MultiPar</b>」を選択すると更にサブ・メニューが出るので、
「<b>リカバリ・ファイルで検査</b>」をクリックします。
</dd></dl>
<dl><dt>
「デスクトップに MultiPar アイコンを作る」にチェックを入れてる場合
</dt><dd>&nbsp
リカバリ・ファイルを選択して MultiPar アイコンの上にドラッグ＆ドロップします。
</dd></dl>
<dl><dt>
「[送る]メニューに MultiPar アイコンを追加する」にチェックを入れてる場合
</dt><dd>&nbsp
エクスプローラーなどでリカバリ・ファイルを選択してから右クリックすると、
右クリック・メニューが表示されます。
その中の「<b>送る</b>」を選択すると更にサブ・メニューが出るので、
「<b>MultiPar</b>」をクリックします。
</dd></dl>
</p>

<h3>破損ファイルを修復する前の準備</h3>
<p>&nbsp
CD-R や DVD-R のような読み取り専用メディアに書き込まれてるファイルを検査してもいいのですが、
破損しててもそのままでは修復できません。
修復する際にはファイルを HDD にコピーする必要があります。
破損したファイルやファイル名の不明な断片であっても、
全てのソース・ファイルとリカバリ・ファイルを HDD 上の同じフォルダに入れてください。
破損したメディアからできるだけ多くのデータを読み取るためには、「<b>ファイル復旧ソフト</b>」を使うといいです。
<a href="http://www.vector.co.jp/vpack/filearea/win/util/disk/care/" target="_blank" title="ディスク・ファイル復旧">ベクターにもこのカテゴリ</a>で有料のから無料のまでいろいろあります。
専門業者の「データ復元サービス」はお金がかかるので、
重要なデータをどうしても取り戻したい時の最後の手段です。
</p>

<hr>

<h3>PAR2 ファイルが不完全で検査できないなら</h3>
<p>&nbsp
PAR2 ファイル内の重要なパケットが失われてると、検査や修復が困難になります。
しかし、複数の PAR2 ファイルを併せれば全種類のパケットが揃うかもしれません。
MultiPar はフォルダ内の同じ基準ファイル名の PAR2 ファイルを自動的に探すので、
同じリカバリ・セットの全ての PAR2 ファイルに対して同じ基準ファイル名を付けるようにしてください。
(基準ファイル名とは拡張子とボリューム番号を除いたファイル名のことです。) 
他の PAR2 ファイルが別のフォルダにあったり、基準ファイル名が異なる場合は、
それらを手動で「追加」してください。
</p>

<h3>ブロック数が足りなくて修復できないなら</h3>
<p>&nbsp
がんばってブロック数を増やしましょう。
別の場所に同じ内容のファイルがあるなら、それもコピーするか手動で「追加」するべきです。
破損したメディアからより多くのデータの痕跡を探しだしてください。
ファイルの断片がどのファイルのか識別できない時は、「<a href="option3.htm#verification_level">検査の程度</a>」を「追加検査」にしてください。
過去にバックアップしてあった古いファイルがあるなら、
たとえ内容が変化していても、それを検査に追加する価値はあります。
</p>
<p>&nbsp
他から入手した時点で破損してたのなら、手元の痕跡に頼ることはできません。
他にもリカバリ・ファイルがあるなら、それも入手してください。
同じファイルが別の所にもあるなら、破損箇所が異なるかもしれないので、
そこから再度入手して追加してもいいです。
それでも駄目なら、配布元にもっと大きな冗長性でリカバリ・ファイルを作ってもらってください。
</p>

<h3>ブロック数が十分あるのに修復に失敗したら</h3>
<p>&nbsp
一番良くあるパターンが「排他制御によるアクセス禁止」や「アクセスする権限が無い」です。
破損ファイルや修復したファイルが排他的にアクセス中だと、それらを置き換えることができません。
例がアンチ・ウイルスで、作業フォルダをリアルタイム検査から除外する必要があるかもしれません。
当然ですが、システムが保護してるファイルは修復 (改変) できません。
修復に失敗した後で破損ファイルの状態が「<b>変更不可</b>」になっていたら、
そのファイルは他のアプリケーションに使われてる最中です。
リカバリ・ブロック数がぎりぎりだと PAR1/2 仕様の欠陥で失敗することがあるので、
利用可能なブロック数を 1 個だけ多く確保すると解決するかもしれません。
</p>

</body>
</html>
